dinCachePlugin for Symfony 1.3/1.4
==================================

Документацию на английском смотрите в README.md

Краткая информация о плагине
----------------------------
Плагин предназначен для реализации «умного» кеширования.
Суть метода состоит в том, что кеш удаляется только при изменении в оригинальных данных. Для этого
используется система правил, похожая на роутинг. В правиле описываются все зависимости данных,
формирование ключей и путей, выбор кеширующего механизма и другие настройки. Сам менеджер кеша
работает как прокси, все запросы данных адресуются ему, а он уже либо берет данные из кеша, либо сам
запрашивает их у ORM.

Когда через менеджер кеша запрашиваются данные по определенному ключу (названию правила), он
проверяет, есть ли такие данные в кеше. Если данные есть - они отдаются. Если нет - на основании
правила делается запрос к модели ORM, полученные данные обрабатываются в зависимости от типа и
сохраняются в кеше. Когда в каком-либо объекте какой-либо модели что-либо меняется (добавляется
новый, удаляется или модифицируется существующий), то отправляется команда на проверку и удаление
связанного кеша. Менеджер эту команду обрабатывает и в случае нахождения подходящих правил - удаляет
все связанные с объектом закешированные данные.

Основные достоинства
--------------------
* Благодаря своей легкости и отсутствию необходимости загружать ORM при наличии данных в кеше экономит массу ресурсов
* Время жизни кеша ограничено только его актуальностью - пока частично или полностью не изменятся оригинальные данные
* Гибкое управление кешированием данных при помощи конфигурационного файла в yml

Текущине ограничения
--------------------
* На данный момент поддерживается работа только с ORM Doctrine 1.2
* На данный момент протестирована работа только с файловым кешем

Зависимости
-----------
* [Symfony](http://www.symfony-project.org/) 1.3/1.4
* [Doctrine](http://www.doctrine-project.org/) 1.2

Установка
---------
Для удобства менеджер включается в состав доступных через sfContext объектов.
Это требует добавления трех строк в метод setup() файла ProjectConfiguration.class.php:

    $pldir = sfConfig::get( 'sf_plugins_dir' );
    require_once( $pldir . '/dinCachePlugin/lib/config/dinCacheRoutingConfigHandler.php' );
    require_once( $pldir . '/dinCachePlugin/lib/config/dinFactoryConfigHandler.php' );

*При использовании в проекте плагина dinSymfonyExtraPlugin эту операцию выполнять не нужно*


Далее требуется отредактировать (или скопировать из библиотеки Symfony и отредактировать) файл
config_handlers.yml в вашем приложении, заменив там обработчик для конфигурации фабрик:

    'config/factories.yml':
        class:          'dinFactoryConfigHandler'

и добавив туда же ниже обработчик для конфигурации менеджера кеша:

    'config/cache_routing.yml':
        class:          'dinCacheRoutingConfigHandler'


Далее следует добавить в конфигурационный файл factories.yml вашего приложения следующий блок:

    cache_routing:
        class:                  'dinCacheManager'
        param:
            load_configuration:                 true
            defaults:
                ttl:                            '157680000'
                driver:                         'sfFileCache'
                ipf:                            '1'

* добавлять логичнее всего для всех окружений (all) *


Настройка
---------
В плагине есть базовая настройка для основных типов данных: data, page и choices. О типах чуть ниже.



Теперь вы можете заняться написанием правил для кеширования нужных вам данных.


Использование
-------------


Список задач
------------
1. Добавить поддержку Propel ORM
2. Добавить поддержку произвольных источников данных
3. Развязать менеджер кеша и ORM посредством Event dispatcher
4. Добавить поддержку различных кеширующих механизмов
5. Перевести на работу в качестве сервиса
6. Покрыть тестами
7. Добавить в официальный репозитарий Symfony
8. Выделить плагин в независимый компонент для использования вне фреймворка Symfony